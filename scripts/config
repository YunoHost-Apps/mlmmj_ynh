#!/bin/bash

# Import YunoHost helpers
source /usr/share/yunohost/helpers
source _common.sh

ynh_abort_if_errors

# -------------------------------------------------------------
# Getters
# -------------------------------------------------------------

get__closedlist() {
    if [ -f "$control_dir/closedlist" ]; then
        echo "true"
    else
        echo "false"
    fi
}

get__moderated() {
    if [ -f "$control_dir/moderated" ]; then
        echo "true"
    else
        echo "false"
    fi
}

# -------------------------------------------------------------
# Setters
# -------------------------------------------------------------

set__closedlist() {
    if [[ $main_general_closedlist == true ]]; then
        touch "$control_dir/closedlist"
        ynh_print_info "--message='Created $control_dir/closedlist for closedlist'"
    else
        ynh_secure_remove "$control_dir/closedlist"
        ynh_print_info "--message='Removed $control_dir/closedlist for closedlist'"
    fi
}

set__moderated() {
    if [[ $main_general_moderated == true ]]; then
        touch "$control_dir/moderated"
        ynh_print_info "--message='Created $control_dir/moderated for moderated'"
    else
        ynh_secure_remove "$control_dir/moderated"
        ynh_print_info "--message='Removed $control_dir/moderated for moderated'"
    fi
}

# Execute the appropriate step
ynh_app_config_run $1
